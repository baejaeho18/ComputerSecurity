
CC = gcc
CFLAGS = -Wall -Wextra
LDFLAGS = -lpthread -lssl -lcrypto

SERVER = tls_chat_serv.c
CLIENT = tls_chat_clnt.c
SERV_TARGET = serv
CLNT_TARGET = clnt

all: $(SERV_TARGET) $(CLNT_TARGET)

$(SERV_TARGET): $(SERVER)
	$(CC) $(CFLAGS) -o $@ $^ $(LDFLAGS)

$(CLNT_TARGET): $(CLIENT)
	$(CC) $(CFLAGS) -o $@ $^ $(LDFLAGS)

run: $(SERV_TARGET) $(CLNT_TARGET)
	./$(CLNT_TARGET) 203.252.112.24 9690 Alice & ./$(SERV_TARGET) 9690

server: $(SERV_TARGET)
	./$(SERV_TARGET) 9690

Alice: $(CLNT_TARGET)
	./$(CLNT_TARGET) 203.252.112.24 9690 Alice

Bob: $(CLNT_TARGET)
	./$(CLNT_TARGET) 203.252.112.24 9690 Bob

Carol: $(CLNT_TARGET)
	./$(CLNT_TARGET) 203.252.112.24 9690 Carol

Dave: $(CLNT_TARGET)
	./$(CLNT_TARGET) 203.252.112.24 9690 Dave

Erin: $(CLNT_TARGET)
	./$(CLNT_TARGET) 203.252.112.24 9690 Erin

Frank: $(CLNT_TARGET)
	./$(CLNT_TARGET) 203.252.112.24 9690 Frank

clean:
	rm -f $(SERV_TARGET) $(CLNT_TARGET)